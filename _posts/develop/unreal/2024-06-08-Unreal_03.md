---
layout: post
title:  "[Unreal] 03.C++ 스크립트로 변환"
excerpt : ""
categories: develop
tags: cpp unreal
toc: true
comments : true
use_math : true

date: 2024-06-08
last_modified_at: 2024-06-08
---
> <span style="font-size: 80%">
본 문서는 어소트락 언리얼엔진 게임프로그래머 양성과정의 강의를 토대로 필기한 내용입니다 </span>

<!--more-->

* this unordered seed list will be replaced by the toc
{:toc}

# C++로 스크립트 생성

## 스폰

### PlayerCharacter.h
```cpp

UCLASS()
class STUDY_240601_API APlayerCharacter : public ACharacter
{
...

protected:
	// TObjectPtr은 객체의 메모리 주소를 저장함
	UPROPERTY(VisibleAnywhere)
	TObjectPtr<USpringArmComponent> mArm; // 언리얼 UObject용 포인터 선언
	UPROPERTY(VisibleAnywhere)
	TObjectPtr<UCameraComponent> mCamera;

	// TSubclassOf는 UClass(클래스 타입) 정보를 저장한다
	TSubclassOf<AActor> mBulletClass;

...

protected:
	void OnAttack(const FInputActionValue& InputValue); // OnAttack 함수 선언
	void OnShield(const FInputActionValue& InputValue); // OnShield 함수 선언
}

```



### PlayerCharacter.cpp
```cpp
APlayerCharacter::APlayerCharacter()
{
 	...

	static ConstructorHelpers::FClassFinder<AActor>BulletClassAsset(TEXT("/Script/Engine.Blueprint'/Game/Test/BP_Bullet.BP_Bullet_C'")); // 경로 마지막에 _C 붙여주기

	if (BulletClassAsset.Succeeded()) mBulletClass = BulletClassAsset.Class; // 불렛클래스에셋 생성을 성공하면 미리 만들어 둔 mBulletClass 클래스 타입에 클래스정보
}
```

- `GetWorld()`
  - 전체 월드를 셀을 나눠놓고 그 셀에 소속된 부분을 만들어 낼 수 있다
  - Level, GameMode, WorldSettings, WorldPartitian
  - World안에 Level이 소속되있는 개념

- 스폰을 위해서는 클래스 정보가 필요함
  - `TSubclassOf`는 UClass(클래스 타입) 정보를 저장함
  - `TSubclassOf<AActor> mBulletClass;`
  - 클래스 - 객체 관계를 잘 구분지어 생각하기 
  - **경로 마지막에 _C 붙여주기!**

### InputData.h
```cpp
UCLASS()
class STUDY_240601_API UDefaultInputData : public UObject
{

	...

public:
	UInputAction* mMove = nullptr;
	UInputAction* mAttack = nullptr;
	UInputAction* mShield = nullptr;
};


```

### InputData.cpp

```cpp
// Fill out your copyright notice in the Description page of Project Settings.


#include "InputData.h"

UDefaultInputData::UDefaultInputData()
{

    ...

	static ConstructorHelpers::FObjectFinder<UInputAction>Attack(TEXT("/Script/EnhancedInput.InputAction'/Game/Test/Input/IA_Attack.IA_Attack'")); // 정적 변수로 선언 (프로그램과 생명주기를 함께함)

	if (Attack.Succeeded()) mAttack = Attack.Object;
	
	static ConstructorHelpers::FObjectFinder<UInputAction>Shield(TEXT("/Script/EnhancedInput.InputAction'/Game/Test/Input/IA_Shield.IA_Shield'"));

	if (Shield.Succeeded()) mShield = Shield.Object;

}
```

## 스킬
> Shield를 만들고 플레이어 기준 방어벽을 앞뒤양옆 네방향으로 세우고 시계방향으로 회전


### 
```cpp
```


## 회전

### 입력액션
- Vector2D로 설정
- MouseX (마우스 횡이동), MouseY (마우스 종이동)
- bUse

<p align = "center">
	<img src = "https://github.com/Jinlee0206/Jinlee0206.github.io/assets/105345909/a3b1e723-fad2-405c-9efb-6632dda0aa4d" width = 480>
</p>

<p align = "center">
	<img src = "https://github.com/Jinlee0206/Jinlee0206.github.io/assets/105345909/e55fc56a-be5d-4120-856c-445a588b53c5" width = 480>
</p>


# 실습
- w,s 누르면 -> 탱크 이동
- a,d 누르면 -> 포신 회전
- 마우스 좌우회전 -> 대포 좌우 회전
- 마우스 상하회전 -> 대포 상하 회전
- 마우스 왼쪽클릭 -> 불렛 발사
- 스킬 마우스 1번 -> 불렛 3발 동시 발사
- 일정 시간에 한 번씩 -> 불렛 5발 발사

## 게임모드

```cpp
```

## 